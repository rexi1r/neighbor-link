<!DOCTYPE html>
<html lang="en" data-bs-theme="dark">
<head>
    <meta charset="UTF-8">
    <title>Step 5</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="styles/bootstrap.min.css">
    <link rel="stylesheet" href="styles/style.css">
    <script type="text/javascript" src="scripts/common/bootstrap.bundle.min.js" defer></script>
    <script type="text/javascript" src="scripts/common/loading.js" defer></script>
    <script type="text/javascript" src="scripts/common/ubus.js" defer></script>
    <script type="text/javascript" src="scripts/page-specific/citylink.js" defer></script>
    <script type="text/javascript" src="scripts/common/heartBeat.js" defer></script>
    
</head>
<body>
    <div class="container">
        <!-- Button container with border -->
        <div class="row button-container justify-content-between mt-3 align-items-center">
            <div class="col-auto">
                <a id="back-btn-href" href="guest.html" class="btn btn-light">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrow-bar-left" viewBox="0 0 16 16">
                        <path fill-rule="evenodd" d="M12.5 15a.5.5 0 0 1-.5-.5v-13a.5.5 0 0 1 1 0v13a.5.5 0 0 1-.5.5M10 8a.5.5 0 0 1-.5.5H3.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L3.707 7.5H9.5a.5.5 0 0 1 .5.5"/>
                    </svg>
                    <span id="back-btn-text">Previous</span>
                </a>
            </div>
            <div class="col text-center">
                <h6 class="mb-0">Step 5:<br>CityLink - Setup Access to Starlink via Iran Internet</h6>
            </div>
            <div class="col-auto">
                <a href="dashboard.html" class="btn btn-light">Dashboard  
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrow-bar-right" viewBox="0 0 16 16">
                        <path fill-rule="evenodd" d="M6 8a.5.5 0 0 0 .5.5h5.793l-2.147 2.146a.5.5 0 0 0 .708.708l3-3a.5.5 0 0 0 0-.708l-3-3a.5.5 0 0 0-.708.708L12.293 7.5H6.5A.5.5 0 0 0 6 8m-2.5 7a.5.5 0 0 1-.5-.5v-13a.5.5 0 0 1 1 0v13a.5.5 0 0 1-.5.5"/>
                    </svg>
                </a>
            </div>
        </div>
        
        <!-- Note and How to  -->
        <div class="row justify-content-center mt-3">
            
            <!-- Note -->
            <div class="alert alert-info alert-dismissible fade show" role="alert" >
                <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close" ></button>
                <div class="english-text">
                    <div class="position-absolute top-0 start-0" style="margin-top: 3px; margin-left: 3px;">
                        <button type="button" class="btn btn-outline-light btn-sm fa-btn">فارسی</button>
                    </div>
                    <h6 class="alert-heading mb-1 text-center">Note:</h6>
                    You can now configure CityLink to access your autonomous internet source (e.g., Starlink) remotely through the Iranian internet network.
                    <ul>
                        <li>At this step, you will be able to set up two connection types: Outline and Proxy.</li>
                        <li>To use Outline, you need an Outline access key, which can be obtained from various sources, including websites and Telegram channels (sometimes for free).</li>
                        <li>We recommend setting up an Outline server outside of Iran for better performance and reliability.</li>
                        <li>Note that if you use Outline, split tunneling will not be possible, meaning you cannot use domestic and international services simultaneously.</li>
                    </ul>
                </div>
                <div dir="rtl" class="farsi-text">
                    <div class="position-absolute top-0 start-0" style="margin-top: 3px; margin-left: 3px;">
                        <button type="button" class="btn btn-outline-light btn-sm en-btn">English</button>
                    </div>
                    <h6 class="alert-heading mb-1 text-center">توضیحات:</h6>
                    اکنون می‌توانید با پیکربندی سیتی‌لینک (CityLink) از راه دور از طریق شبکه داخلی اینترنت کشور به استارلینک دسترسی پیدا کنید.
                    <ul>
                        <li>در این مرحله می‌توانید به‌سادگی دو اتصال اوتلاین (Outline) و پروکسی (Proxy) را پیکربندی کنید.</li>
                        <li>برای اتصال اوتلاین، نیاز به یک Outline access key دارید. این کلید را می‌توانید از منابع مختلف، از جمله وب‌سایت‌ها و کانال‌های تلگرامی، حتی به‌طور رایگان دریافت کنید.</li>
                        <li>توصیه می‌کنیم یک سرور در خارج از کشور تهیه کرده و اوتلاین را روی آن بارگذاری کنید تا اتصال اختصاصی و پرسرعت خود را داشته باشید.</li>
                        <li>دقت کنید که در صورت استفاده از اوتلاین، امکان تفکیک مسیر یا اسپلیت‌تانلینگ (Split Tunneling) نخواهید داشت و نمی‌توانید هم‌زمان از سرویس‌های داخلی و بین‌المللی استفاده کنید.</li>
                        <li>اگر از پروکسی استفاده کنید، می‌توانید از قابلیت اسپلیت‌تانلینگ بهره‌مند شوید.</li>
                    </ul>
                </div>
            </div>
            
            <!-- How to  -->
            <div class="alert alert-light" role="alert">
                <div class="english-text">
                    <div class="position-absolute top-0 start-0" style="margin-top: 3px; margin-left: 3px;">
                        <button type="button" class="btn btn-outline-light btn-sm fa-btn">فارسی</button>
                    </div>
                    <h6 class="alert-heading mb-1 text-center">Instruction:</h6>
                    <ul>
                        <li>Obtain an Iran-based VPS running Ubuntu 22.04 or a later version.</li>
                        <li>SSH into the server and run the following command to prepare the server:
                        <br><span class="text text-warning font-monospace fw-lighter" style="font-size: 9px;">sudo bash -c "$(wget -qO- https://raw.githubusercontent.com/nasnet-community/neighbor-link/refs/heads/main/server/Iran_server/Iran_server_setup.sh)"</span></li>
                        <li>Copy the installation output and paste it into the connection string section of the configuration.</li>
                        <li>Click on “Connect” and wait for the connection to establish.</li>
                        <li>Once connected, you will be able to select between the Proxy or Outline solution.</li>
                    </ul>
                </div>
                <div dir="rtl" class="farsi-text">
                    <div class="position-absolute top-0 start-0" style="margin-top: 3px; margin-left: 3px;">
                        <button type="button" class="btn btn-outline-light btn-sm en-btn">English</button>
                    </div>
                    <h6 class="alert-heading mb-1 text-center">راهنما</h6>
                    <ul>
                        <li>یک VPS داخل ایران با سیستم‌عامل Ubuntu 22.04 یا نسخه‌های جدیدتر تهیه کنید.</li>
                        <li>از طریق SSH به سرور متصل شده و دستور زیر را برای آماده‌سازی سرور اجرا کنید:
                        <br><span class="text text-warning font-monospace fw-lighter" style="font-size: 9px;">sudo bash -c "$(wget -qO- https://raw.githubusercontent.com/nasnet-community/neighbor-link/refs/heads/main/server/Iran_server/Iran_server_setup.sh)"</span></li>
                        <li>خروجی نصب را کپی کرده و در بخش connection string وارد کنید.</li>
                        <li>روی گزینه “Connect” کلیک کرده و منتظر بمانید تا اتصال برقرار شود.</li>
                        <li>پس از برقراری اتصال، می‌توانید بین دو راه‌حل پروکسی (Proxy) یا اوتلاین (Outline) انتخاب کنید.</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Alert -->
        <h2 class="text-warning mt-3">CityLink Connection</h2>
        <hr>
        <div class="container row">
            <div id="alertContainer" class="col"></div>
        </div>
        <div id="connection-status" class="row alert alert-danger justify-content-center align-items-center">
            <div class="col">
                <div class="row">
                    <div class="col text-start">
                        <strong>Status: Disconnected</strong>
                    </div>
                </div>
                <div class="row">
                    <div class="col text-start">
                        <strong></strong>
                    </div>
                </div>
            </div>
            <div class="col text-end">
                <button class="btn btn-outline-light d-none" type="button" id="disconnect-btn">
                    <span>Disconnect</span>
                </button>
            </div>
        </div>
        <div class="input-group my-3" id="connection-section">
            <span class="input-group-text" id="connection-part">Connection String</span>
            <input id="connection-string" type="text" class="form-control" placeholder="InR:string:string:...@host" aria-label="Username" aria-describedby="connection-part">
            <button class="btn btn-primary" type="button" id="connect-btn" style="width: 85px">
                <span>Connect</span>
                <div class="spinner-grow spinner-grow-sm text-light" role="status" style="display: none">
                    <span class="visually-hidden">Loading...</span>
                  </div>
            </button>
        </div>


        <div class="row justify-content-between align-items-center g-2" id="config-cards">
            <div class="col">
                <div class="card">
                    
                    <div class="card-body">
                        <h3 class="card-title">Outline Relay</h4>
                        <p class="card-text text-body fw-lighter" >Convert Global Outline config to use in Iran</p> 
                        <a href="outline.html" class="btn btn-outline-primary">setup</a>
                    </div>
                </div>
                
            </div>
            <div class="col">
                <div class="card">
                    
                    <div class="card-body">
                        <h3 class="card-title">HTTPS Proxy</h4>
                        <p class="card-text text-body fw-lighter" >Proxy configuration</p> 
                        <a href="proxy.html" class="btn btn-outline-primary">setup</a>
                    </div>
                </div>
                
            </div>
        </div>
        
        
    </div>
    <div class="row mb-5 mt-5"></div>
    <div id="overlay" class="display=none flex-column align-items-center mb-3">
        <div class="spinner-border text-light mb-2" role="status">
            <span class="visually-hidden">Loading...</span>
        </div>
        <div class="fs-4 px-4 py-3" role="message">
            <h6 id="overlay_message" class="text text-light">
             Loading...   
            </h6>
        </div>
    </div> 
 
    <div class="toast-container position-fixed  top-0 start-0 text-center" style="width: 100%;">
        <div id="liveToast" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-bs-delay="3000" style="width: 100%">
            <div class="alert alert-danger m-0" role="alert">You're not connected to router!</div>
        </div>
    </div>
</body>
</html>
